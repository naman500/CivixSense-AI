
# Real-Time Crowd Detection and Monitoring System

An intelligent system for real-time crowd detection and monitoring using hybrid detection(YOLOV8n & YOLOV8m) approaches.

## Features

- **Hybrid Detection**: Combines YOLOV8(n & m) object detection 
- **Adaptive Selection**: Switches between models based on crowd density
- **Real-time Monitoring**: Web dashboard for monitoring cameras and crowds
- **Alert System**: Configurable alerts based on crowd thresholds
- **Multi-camera Support**: Monitor multiple cameras simultaneously

## Installation

1. Clone the repository:
   ```bash
   git clone https://github.com/your-username/crowd-detection-system.git
   cd crowd-detection-system
   ```

2. Create a virtual environment (optional but recommended):
   ```bash
   python -m venv venv
   # On Windows:
   venv\Scripts\activate
   # On Linux/Mac:
   source venv/bin/activate
   ```

3. Install dependencies:
   ```bash
   pip install -r requirements.txt
   ```

4. Download required models:
   ```bash
   python RTCDM/download_models.py
   ```
   Or manually place model files (`yolov8n.pt`, `yolov8m.pt`, `.onnx` files) in the appropriate directories (`RTCDM/models/` or project root).

5. (Optional) See `Virtual environment creation Steps in terminal.txt` for detailed setup instructions.

## Running the Application

There are two ways to run the application:

### Method 1: Using run.py (Recommended)

```bash
python run.py
```

### Method 2: Using the main module directly

```bash
cd RTCDM
python main.py
```

Once started, open your browser and navigate to:
```
http://localhost:5000
```

## Adding Cameras

1. From the dashboard, click "Add Camera"
2. Enter camera details:
   - Camera ID: A unique identifier
   - Camera Name: A display name
   - Camera URL: IP camera URL or webcam index (0 for default webcam)
   - Crowd Threshold: Number at which alerts are triggered
   - Density Threshold: Value at which detection switches to hybrid mode

## Configuration

- Camera configurations are stored in `RTCDM/cameras.json`
- Alert settings are stored in `RTCDM/alerts/alert_config.json`

## Project Structure

```
├── RTCDM/                      # Main package
│   ├── main.py                 # Application core
│   ├── app.py                  # App entry (for some deployments)
│   ├── download_models.py      # Model downloader
│   ├── cameras/                # Camera management
│   │   ├── __init__.py
│   │   ├── camera_manager.py
│   │   └── stream_utils.py
│   ├── detection/              # Detection models
│   │   ├── __init__.py
│   │   ├── yolo_model.py
│   │   ├── hybrid_detector.py
│   │   ├── detection_utils.py
│   │   ├── model_utils.py
│   │   └── model_manager.py
│   ├── alerts/                 # Alert system
│   │   ├── __init__.py
│   │   ├── alert_manager.py
│   │   ├── alert_config.json
│   │   └── alert_history.json
│   ├── dashboard/              # Web dashboard
│   │   ├── __init__.py
│   │   ├── dashboard.py
│   │   ├── templates/
│   │   │   └── dashboard_template.html
│   │   └── static/
│   │       ├── js/
│   │       │   └── dashboard.js
│   │       ├── images/
│   │       │   ├── alert-icon.png
│   │       │   ├── alert-icon.svg
│   │       │   ├── favicon.ico
│   │       │   └── Main_logo.jpg
│   │       ├── audio/
│   │       │   └── Overcrowd_Detected__.mp3
│   │       └── css/
│   ├── models/                 # Model storage (.onnx files)
│   │   ├── yolov8n.onnx
│   │   └── yolov8m.onnx
│   └── tests/                  # Test files
│       ├── __init__.py
│       ├── test_camera.py
│       ├── test_webcam.py
│       ├── test_hybrid_detector.py
│       └── test_images/
├── run.py                      # Entry point script
├── cleanup.py                  # Utility: clean up old files or logs
├── test_webcam.py              # Utility: test webcam connectivity
├── verify_cuda_setup.py        # Utility: verify CUDA installation
├── requirements.txt            # Dependencies
├── yolov8n.pt                  # YOLOv8 nano model (PyTorch)
├── yolov8m.pt                  # YOLOv8 medium model (PyTorch)
├── Virtual environment creation Steps in terminal.txt # Step-by-step setup guide
└── .vscode/                    # VSCode settings
```

## System Architecture

The system consists of several components:

1. **Camera Manager** – Manages IP camera connections and configurations
2. **Detection Models**:
   - **YOLO Model** – Object detection to count people
   - **Hybrid Detector** – Combines object detection 
3. **Alert Manager** – Handles threshold-based alerts and suggested actions
4. **Dashboard** – Web interface for monitoring and control (with static assets and templates)

## Utility Scripts

- `cleanup.py`: Cleans up old files or logs generated by the system.
- `test_webcam.py`: Tests webcam connectivity and configuration.
- `verify_cuda_setup.py`: Verifies CUDA installation and GPU compatibility.
- `download_models.py`: Downloads required model files.

## Dashboard Assets

- **Templates**: Located in `RTCDM/dashboard/templates/`
- **Static Files**: JavaScript, images, audio, and (optionally) CSS in `RTCDM/dashboard/static/`

## Testing

To run the test scripts:
```bash
cd RTCDM/tests
python -m unittest discover
```
Or run individual test files directly:
```bash
python test_camera.py
python test_webcam.py
python test_hybrid_detector.py
```

## Troubleshooting

- **Camera Connection Issues**: Ensure camera URLs are correct and accessible
- **Model Loading Errors**: Check if model files are correctly placed in their respective directories
- **Performance Issues**: Consider lowering resolution or frame rate for better performance
- **CUDA Issues**: Use `verify_cuda_setup.py` to check your CUDA/GPU setup

## License

This project is licensed under the MIT License - see the LICENSE file for details.

## Acknowledgments

- YOLO: https://github.com/AlexeyAB/darknet
- CSRNet: https://github.com/leeyeehoo/CSRNet-pytorch 



